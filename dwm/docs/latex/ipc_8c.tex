\doxysection{dwm/ipc.c File Reference}
\hypertarget{ipc_8c}{}\label{ipc_8c}\index{dwm/ipc.c@{dwm/ipc.c}}


Part jdwm\textquotesingle{}s IPC (Inter Process Communication) system, originally written by Mihir Lad as the \href{https://github.com/mihirlad55/dwm-ipc}{\texttt{ \textquotesingle{}dwm-\/ipc\textquotesingle{} patch}}  


{\ttfamily \#include "{}ipc.\+h"{}}\newline
{\ttfamily \#include $<$errno.\+h$>$}\newline
{\ttfamily \#include $<$fcntl.\+h$>$}\newline
{\ttfamily \#include $<$inttypes.\+h$>$}\newline
{\ttfamily \#include $<$stdarg.\+h$>$}\newline
{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$sys/epoll.\+h$>$}\newline
{\ttfamily \#include $<$sys/socket.\+h$>$}\newline
{\ttfamily \#include $<$sys/un.\+h$>$}\newline
{\ttfamily \#include $<$unistd.\+h$>$}\newline
{\ttfamily \#include $<$yajl/yajl\+\_\+gen.\+h$>$}\newline
{\ttfamily \#include $<$yajl/yajl\+\_\+tree.\+h$>$}\newline
{\ttfamily \#include "{}util.\+h"{}}\newline
{\ttfamily \#include "{}yajl\+\_\+dumps.\+h"{}}\newline
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
static int \mbox{\hyperlink{ipc_8c_a24cc0ccb126718cb2c37218b34619ff5}{ipc\+\_\+create\+\_\+socket}} (const char \texorpdfstring{$\ast$}{*}filename)
\item 
static int \mbox{\hyperlink{ipc_8c_a7fd2c1a0cc44fbe09d6f988ca7c99a88}{ipc\+\_\+recv\+\_\+message}} (int fd, uint8\+\_\+t \texorpdfstring{$\ast$}{*}msg\+\_\+type, uint32\+\_\+t \texorpdfstring{$\ast$}{*}reply\+\_\+size, uint8\+\_\+t \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}reply)
\item 
static ssize\+\_\+t \mbox{\hyperlink{ipc_8c_a86729db12b9db3d911dc592ecc2930f8}{ipc\+\_\+write\+\_\+message}} (int fd, const void \texorpdfstring{$\ast$}{*}buf, size\+\_\+t count)
\item 
static void \mbox{\hyperlink{ipc_8c_a4935c3928882f8336e0d13c33c5e923d}{ipc\+\_\+event\+\_\+init\+\_\+message}} (yajl\+\_\+gen \texorpdfstring{$\ast$}{*}gen)
\item 
static void \mbox{\hyperlink{ipc_8c_adf8ed4dd3c897d54e359f1b515e11502}{ipc\+\_\+event\+\_\+prepare\+\_\+send\+\_\+message}} (yajl\+\_\+gen gen, IPCEvent event)
\item 
static void \mbox{\hyperlink{ipc_8c_a8e0ae039e25afaec7105ef098ed57210}{ipc\+\_\+reply\+\_\+init\+\_\+message}} (yajl\+\_\+gen \texorpdfstring{$\ast$}{*}gen)
\item 
static void \mbox{\hyperlink{ipc_8c_aa5ea924e4684f691acf4bcb261e0fd0c}{ipc\+\_\+reply\+\_\+prepare\+\_\+send\+\_\+message}} (yajl\+\_\+gen gen, \mbox{\hyperlink{structIPCClient}{IPCClient}} \texorpdfstring{$\ast$}{*}c, IPCMessage\+Type msg\+\_\+type)
\item 
static int \mbox{\hyperlink{ipc_8c_ab90da44218163c22a2e1bd7fcb11f326}{ipc\+\_\+get\+\_\+ipc\+\_\+command}} (const char \texorpdfstring{$\ast$}{*}name, \mbox{\hyperlink{structIPCCommand}{IPCCommand}} \texorpdfstring{$\ast$}{*}ipc\+\_\+command)
\item 
static int \mbox{\hyperlink{ipc_8c_a2bbc25ad0d14a7a741b613c2ef9ba951}{ipc\+\_\+parse\+\_\+run\+\_\+command}} (char \texorpdfstring{$\ast$}{*}msg, \mbox{\hyperlink{structIPCParsedCommand}{IPCParsed\+Command}} \texorpdfstring{$\ast$}{*}parsed\+\_\+command)
\item 
static void \mbox{\hyperlink{ipc_8c_a8dd4ef35088efa38b07140e9517d7191}{ipc\+\_\+free\+\_\+parsed\+\_\+command\+\_\+members}} (\mbox{\hyperlink{structIPCParsedCommand}{IPCParsed\+Command}} \texorpdfstring{$\ast$}{*}command)
\item 
static int \mbox{\hyperlink{ipc_8c_a7f64a35eddb67c378b079f8f7373fc66}{ipc\+\_\+validate\+\_\+run\+\_\+command}} (\mbox{\hyperlink{structIPCParsedCommand}{IPCParsed\+Command}} \texorpdfstring{$\ast$}{*}parsed, const \mbox{\hyperlink{structIPCCommand}{IPCCommand}} actual)
\item 
static int \mbox{\hyperlink{ipc_8c_a59a776fc01c2e23d5d7b9dab10ae9b9c}{ipc\+\_\+event\+\_\+stoi}} (const char \texorpdfstring{$\ast$}{*}subscription, IPCEvent \texorpdfstring{$\ast$}{*}event)
\item 
static int \mbox{\hyperlink{ipc_8c_af2c9b7fcd327dfb3bef6bce5d6c8b88a}{ipc\+\_\+parse\+\_\+subscribe}} (const char \texorpdfstring{$\ast$}{*}msg, IPCSubscription\+Action \texorpdfstring{$\ast$}{*}subscribe, IPCEvent \texorpdfstring{$\ast$}{*}event)
\item 
static int \mbox{\hyperlink{ipc_8c_aa78fb2d629fe72e8494b88cb39b500e1}{ipc\+\_\+parse\+\_\+get\+\_\+dwm\+\_\+client}} (const char \texorpdfstring{$\ast$}{*}msg, Window \texorpdfstring{$\ast$}{*}win)
\item 
static int \mbox{\hyperlink{ipc_8c_a66568f558397fd5df9c108d69c7c8102}{ipc\+\_\+run\+\_\+command}} (\mbox{\hyperlink{structIPCClient}{IPCClient}} \texorpdfstring{$\ast$}{*}ipc\+\_\+client, char \texorpdfstring{$\ast$}{*}msg)
\item 
static void \mbox{\hyperlink{ipc_8c_a99392099329bbfd860cbba61d7147963}{ipc\+\_\+get\+\_\+monitors}} (\mbox{\hyperlink{structIPCClient}{IPCClient}} \texorpdfstring{$\ast$}{*}c, \mbox{\hyperlink{structMonitor}{Monitor}} \texorpdfstring{$\ast$}{*}mons, \mbox{\hyperlink{structMonitor}{Monitor}} \texorpdfstring{$\ast$}{*}selmon)
\item 
static void \mbox{\hyperlink{ipc_8c_a14c26dbee01f2d8994aac3e546174787}{ipc\+\_\+get\+\_\+tags}} (\mbox{\hyperlink{structIPCClient}{IPCClient}} \texorpdfstring{$\ast$}{*}c, const char \texorpdfstring{$\ast$}{*}tags\mbox{[}$\,$\mbox{]}, const int tags\+\_\+len)
\item 
static void \mbox{\hyperlink{ipc_8c_a72c4e39d99a68640f80c5a78ab367dca}{ipc\+\_\+get\+\_\+layouts}} (\mbox{\hyperlink{structIPCClient}{IPCClient}} \texorpdfstring{$\ast$}{*}c, const \mbox{\hyperlink{structLayout}{Layout}} layouts\mbox{[}$\,$\mbox{]}, const int layouts\+\_\+len)
\item 
static int \mbox{\hyperlink{ipc_8c_a240daa63677ae1333ead3c287a086e8a}{ipc\+\_\+get\+\_\+dwm\+\_\+client}} (\mbox{\hyperlink{structIPCClient}{IPCClient}} \texorpdfstring{$\ast$}{*}ipc\+\_\+client, const char \texorpdfstring{$\ast$}{*}msg, const \mbox{\hyperlink{structMonitor}{Monitor}} \texorpdfstring{$\ast$}{*}mons)
\item 
static int \mbox{\hyperlink{ipc_8c_ae95a061a3193d0f615183dc704c62717}{ipc\+\_\+subscribe}} (\mbox{\hyperlink{structIPCClient}{IPCClient}} \texorpdfstring{$\ast$}{*}c, const char \texorpdfstring{$\ast$}{*}msg)
\item 
int \mbox{\hyperlink{ipc_8c_a0075a47c0fd4b8176a483263b656aa55}{ipc\+\_\+init}} (const char \texorpdfstring{$\ast$}{*}socket\+\_\+path, const int p\+\_\+epoll\+\_\+fd, \mbox{\hyperlink{structIPCCommand}{IPCCommand}} commands\mbox{[}$\,$\mbox{]}, const int commands\+\_\+len)
\item 
void \mbox{\hyperlink{ipc_8c_a5cd86734203d73e9a1ed798b28aac43f}{ipc\+\_\+cleanup}} ()
\item 
int \mbox{\hyperlink{ipc_8c_aaf6a34c4926a5daeb5e86a3810df1927}{ipc\+\_\+get\+\_\+sock\+\_\+fd}} ()
\item 
\mbox{\hyperlink{structIPCClient}{IPCClient}} \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{ipc_8c_a3547c5a2191240ab550d351548bf74da}{ipc\+\_\+get\+\_\+client}} (int fd)
\item 
int \mbox{\hyperlink{ipc_8c_a7b06b9405d28f83b70abef476c96586b}{ipc\+\_\+is\+\_\+client\+\_\+registered}} (int fd)
\item 
int \mbox{\hyperlink{ipc_8c_ac4cf9ef8e563e9ab39dca46e91bef9dd}{ipc\+\_\+accept\+\_\+client}} ()
\item 
int \mbox{\hyperlink{ipc_8c_a2691ad7177c992404f030ec077caf951}{ipc\+\_\+drop\+\_\+client}} (\mbox{\hyperlink{structIPCClient}{IPCClient}} \texorpdfstring{$\ast$}{*}c)
\item 
int \mbox{\hyperlink{ipc_8c_a7fc2b53d563fbe5b5cd2d18ed896515a}{ipc\+\_\+read\+\_\+client}} (\mbox{\hyperlink{structIPCClient}{IPCClient}} \texorpdfstring{$\ast$}{*}c, IPCMessage\+Type \texorpdfstring{$\ast$}{*}msg\+\_\+type, uint32\+\_\+t \texorpdfstring{$\ast$}{*}msg\+\_\+size, char \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}msg)
\item 
ssize\+\_\+t \mbox{\hyperlink{ipc_8c_a17a7e48abf6934919ddfa34a6b59190b}{ipc\+\_\+write\+\_\+client}} (\mbox{\hyperlink{structIPCClient}{IPCClient}} \texorpdfstring{$\ast$}{*}c)
\item 
void \mbox{\hyperlink{ipc_8c_a3f8724e9a4d13f3f740424b4bd2cd320}{ipc\+\_\+prepare\+\_\+send\+\_\+message}} (\mbox{\hyperlink{structIPCClient}{IPCClient}} \texorpdfstring{$\ast$}{*}c, const IPCMessage\+Type msg\+\_\+type, const uint32\+\_\+t msg\+\_\+size, const char \texorpdfstring{$\ast$}{*}msg)
\item 
void \mbox{\hyperlink{ipc_8c_a6efdf4e155c8f0affd6a54036b4583ba}{ipc\+\_\+prepare\+\_\+reply\+\_\+failure}} (\mbox{\hyperlink{structIPCClient}{IPCClient}} \texorpdfstring{$\ast$}{*}c, IPCMessage\+Type msg\+\_\+type, const char \texorpdfstring{$\ast$}{*}format,...)
\item 
void \mbox{\hyperlink{ipc_8c_a4de330d510471cdc8ab4e81ce6b454ec}{ipc\+\_\+prepare\+\_\+reply\+\_\+success}} (\mbox{\hyperlink{structIPCClient}{IPCClient}} \texorpdfstring{$\ast$}{*}c, IPCMessage\+Type msg\+\_\+type)
\item 
void \mbox{\hyperlink{ipc_8c_a2ff1e8a64c64d31fa5f73ea96b53d04f}{ipc\+\_\+tag\+\_\+change\+\_\+event}} (int mon\+\_\+num, \mbox{\hyperlink{structTagState}{Tag\+State}} old\+\_\+state, \mbox{\hyperlink{structTagState}{Tag\+State}} new\+\_\+state)
\item 
void \mbox{\hyperlink{ipc_8c_a6fcb91c772f154d23c1a76f2281553d7}{ipc\+\_\+client\+\_\+focus\+\_\+change\+\_\+event}} (int mon\+\_\+num, \mbox{\hyperlink{structClient}{Client}} \texorpdfstring{$\ast$}{*}old\+\_\+client, \mbox{\hyperlink{structClient}{Client}} \texorpdfstring{$\ast$}{*}new\+\_\+client)
\item 
void \mbox{\hyperlink{ipc_8c_ac93313ec475fade29aa3f6182624da88}{ipc\+\_\+layout\+\_\+change\+\_\+event}} (const int mon\+\_\+num, const char \texorpdfstring{$\ast$}{*}old\+\_\+symbol, const \mbox{\hyperlink{structLayout}{Layout}} \texorpdfstring{$\ast$}{*}old\+\_\+layout, const char \texorpdfstring{$\ast$}{*}new\+\_\+symbol, const \mbox{\hyperlink{structLayout}{Layout}} \texorpdfstring{$\ast$}{*}new\+\_\+layout)
\item 
void \mbox{\hyperlink{ipc_8c_a30f10dd1fb42c40505a0bb0e554e1f1a}{ipc\+\_\+monitor\+\_\+focus\+\_\+change\+\_\+event}} (const int last\+\_\+mon\+\_\+num, const int new\+\_\+mon\+\_\+num)
\item 
void \mbox{\hyperlink{ipc_8c_aa641e7730c197a51c3e68fca7cc07ee5}{ipc\+\_\+focused\+\_\+title\+\_\+change\+\_\+event}} (const int mon\+\_\+num, const Window client\+\_\+id, const char \texorpdfstring{$\ast$}{*}old\+\_\+name, const char \texorpdfstring{$\ast$}{*}new\+\_\+name)
\item 
void \mbox{\hyperlink{ipc_8c_aafbc9c45dbce577a3a62275f72d63867}{ipc\+\_\+focused\+\_\+state\+\_\+change\+\_\+event}} (const int mon\+\_\+num, const Window client\+\_\+id, const \mbox{\hyperlink{structClientState}{Client\+State}} \texorpdfstring{$\ast$}{*}old\+\_\+state, const \mbox{\hyperlink{structClientState}{Client\+State}} \texorpdfstring{$\ast$}{*}new\+\_\+state)
\item 
void \mbox{\hyperlink{ipc_8c_a501706e7a2244abe719cefa19a6cfb04}{ipc\+\_\+send\+\_\+events}} (\mbox{\hyperlink{structMonitor}{Monitor}} \texorpdfstring{$\ast$}{*}mons, \mbox{\hyperlink{structMonitor}{Monitor}} \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}lastselmon, \mbox{\hyperlink{structMonitor}{Monitor}} \texorpdfstring{$\ast$}{*}selmon)
\item 
int \mbox{\hyperlink{ipc_8c_ac2e89d3423dd343b78dd422ec54e6dce}{ipc\+\_\+handle\+\_\+client\+\_\+epoll\+\_\+event}} (struct epoll\+\_\+event \texorpdfstring{$\ast$}{*}ev, \mbox{\hyperlink{structMonitor}{Monitor}} \texorpdfstring{$\ast$}{*}mons, \mbox{\hyperlink{structMonitor}{Monitor}} \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}lastselmon, \mbox{\hyperlink{structMonitor}{Monitor}} \texorpdfstring{$\ast$}{*}selmon, const char \texorpdfstring{$\ast$}{*}tags\mbox{[}$\,$\mbox{]}, const int tags\+\_\+len, const \mbox{\hyperlink{structLayout}{Layout}} \texorpdfstring{$\ast$}{*}layouts, const int layouts\+\_\+len)
\item 
int \mbox{\hyperlink{ipc_8c_a90ff3f5975686c3cefb6da204077fc9d}{ipc\+\_\+handle\+\_\+socket\+\_\+epoll\+\_\+event}} (struct epoll\+\_\+event \texorpdfstring{$\ast$}{*}ev)
\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{ipc_8c_a02e49a0b91e49434adaa83e4e901f38b}\label{ipc_8c_a02e49a0b91e49434adaa83e4e901f38b} 
static struct sockaddr\+\_\+un {\bfseries sockaddr}
\item 
\Hypertarget{ipc_8c_ad3319d0458b34c289cd0946ed9a4bc36}\label{ipc_8c_ad3319d0458b34c289cd0946ed9a4bc36} 
static struct epoll\+\_\+event {\bfseries sock\+\_\+epoll\+\_\+event}
\item 
\Hypertarget{ipc_8c_abf5bdd5909a0a5a5d4c09044e67dd7e8}\label{ipc_8c_abf5bdd5909a0a5a5d4c09044e67dd7e8} 
static \mbox{\hyperlink{structIPCClient}{IPCClient\+List}} {\bfseries ipc\+\_\+clients} = NULL
\item 
\Hypertarget{ipc_8c_ae4afe2171ee3ec9b9cce747171f0b20d}\label{ipc_8c_ae4afe2171ee3ec9b9cce747171f0b20d} 
static int {\bfseries epoll\+\_\+fd} = -\/1
\item 
\Hypertarget{ipc_8c_a514331e6141a28289f8ddead55eadebd}\label{ipc_8c_a514331e6141a28289f8ddead55eadebd} 
static int {\bfseries sock\+\_\+fd} = -\/1
\item 
\Hypertarget{ipc_8c_a47c873e8f5b38fcb08205a81d3e422c0}\label{ipc_8c_a47c873e8f5b38fcb08205a81d3e422c0} 
static \mbox{\hyperlink{structIPCCommand}{IPCCommand}} \texorpdfstring{$\ast$}{*} {\bfseries ipc\+\_\+commands}
\item 
\Hypertarget{ipc_8c_a9834462ca51b2040761dc5143c59fb62}\label{ipc_8c_a9834462ca51b2040761dc5143c59fb62} 
static unsigned int {\bfseries ipc\+\_\+commands\+\_\+len}
\item 
\Hypertarget{ipc_8c_a79fa7e89df2b270bfa243af5fb3575fc}\label{ipc_8c_a79fa7e89df2b270bfa243af5fb3575fc} 
static const uint32\+\_\+t {\bfseries MAX\+\_\+\+MESSAGE\+\_\+\+SIZE} = 1000000
\item 
\Hypertarget{ipc_8c_a798b4989172fcfbb0ec0001974088f26}\label{ipc_8c_a798b4989172fcfbb0ec0001974088f26} 
static const int {\bfseries IPC\+\_\+\+SOCKET\+\_\+\+BACKLOG} = 5
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Part jdwm\textquotesingle{}s IPC (Inter Process Communication) system, originally written by Mihir Lad as the \href{https://github.com/mihirlad55/dwm-ipc}{\texttt{ \textquotesingle{}dwm-\/ipc\textquotesingle{} patch}} 

\begin{DoxyAuthor}{Author}
Jeff\+Of\+Bread (\href{https://github.com/JeffofBread}{\texttt{ https\+://github.\+com/\+Jeffof\+Bread}}) \& Mihir Lad (\href{mailto:contact@mihirlad.com}{\texttt{ contact@mihirlad.\+com}}) 
\end{DoxyAuthor}
\begin{DoxySeeAlso}{See also}
\href{https://git.suckless.org/libsl/files.html}{\texttt{ https\+://git.\+suckless.\+org/libsl/files.\+html}} 
\end{DoxySeeAlso}
\begin{DoxyVersion}{Version}
0.\+1 
\end{DoxyVersion}
\begin{DoxyCopyright}{Copyright}
Refer to jdwm\textquotesingle{}s LICENSE file\+: \href{https://github.com/JeffofBread/jdwm/blob/master/LICENSE}{\texttt{ https\+://github.\+com/\+Jeffof\+Bread/jdwm/blob/master/\+LICENSE}} 
\end{DoxyCopyright}


\doxysubsection{Function Documentation}
\Hypertarget{ipc_8c_ac4cf9ef8e563e9ab39dca46e91bef9dd}\index{ipc.c@{ipc.c}!ipc\_accept\_client@{ipc\_accept\_client}}
\index{ipc\_accept\_client@{ipc\_accept\_client}!ipc.c@{ipc.c}}
\doxysubsubsection{\texorpdfstring{ipc\_accept\_client()}{ipc\_accept\_client()}}
{\footnotesize\ttfamily \label{ipc_8c_ac4cf9ef8e563e9ab39dca46e91bef9dd} 
int ipc\+\_\+accept\+\_\+client (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})}

Accept an IPC Client requesting to connect to the socket and add it to the list of clients

\begin{DoxyReturn}{Returns}
File descriptor of new client, -\/1 on error 
\end{DoxyReturn}
\Hypertarget{ipc_8c_a5cd86734203d73e9a1ed798b28aac43f}\index{ipc.c@{ipc.c}!ipc\_cleanup@{ipc\_cleanup}}
\index{ipc\_cleanup@{ipc\_cleanup}!ipc.c@{ipc.c}}
\doxysubsubsection{\texorpdfstring{ipc\_cleanup()}{ipc\_cleanup()}}
{\footnotesize\ttfamily \label{ipc_8c_a5cd86734203d73e9a1ed798b28aac43f} 
void ipc\+\_\+cleanup (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})}

Uninitialize the socket and module. Free allocated memory and restore static variables to their state before ipc\+\_\+init \Hypertarget{ipc_8c_a6fcb91c772f154d23c1a76f2281553d7}\index{ipc.c@{ipc.c}!ipc\_client\_focus\_change\_event@{ipc\_client\_focus\_change\_event}}
\index{ipc\_client\_focus\_change\_event@{ipc\_client\_focus\_change\_event}!ipc.c@{ipc.c}}
\doxysubsubsection{\texorpdfstring{ipc\_client\_focus\_change\_event()}{ipc\_client\_focus\_change\_event()}}
{\footnotesize\ttfamily \label{ipc_8c_a6fcb91c772f154d23c1a76f2281553d7} 
void ipc\+\_\+client\+\_\+focus\+\_\+change\+\_\+event (\begin{DoxyParamCaption}\item[{const int}]{mon\+\_\+num}{, }\item[{\mbox{\hyperlink{structClient}{Client}} \texorpdfstring{$\ast$}{*}}]{old\+\_\+client}{, }\item[{\mbox{\hyperlink{structClient}{Client}} \texorpdfstring{$\ast$}{*}}]{new\+\_\+client}{}\end{DoxyParamCaption})}

Send a client\+\_\+focus\+\_\+change\+\_\+event to all subscribers. Should be called only when the client focus changes.


\begin{DoxyParams}{Parameters}
{\em mon\+\_\+num} & The index of the monitor (Monitor.\+num property) \\
\hline
{\em old\+\_\+client} & The old DWM client selection (Monitor.\+oldsel) \\
\hline
{\em new\+\_\+client} & The new (now current) DWM client selection \\
\hline
\end{DoxyParams}
\Hypertarget{ipc_8c_a24cc0ccb126718cb2c37218b34619ff5}\index{ipc.c@{ipc.c}!ipc\_create\_socket@{ipc\_create\_socket}}
\index{ipc\_create\_socket@{ipc\_create\_socket}!ipc.c@{ipc.c}}
\doxysubsubsection{\texorpdfstring{ipc\_create\_socket()}{ipc\_create\_socket()}}
{\footnotesize\ttfamily \label{ipc_8c_a24cc0ccb126718cb2c37218b34619ff5} 
static int ipc\+\_\+create\+\_\+socket (\begin{DoxyParamCaption}\item[{const char \texorpdfstring{$\ast$}{*}}]{filename}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

Create IPC socket at specified path and return file descriptor to socket. This initializes the static variable sockaddr. \Hypertarget{ipc_8c_a2691ad7177c992404f030ec077caf951}\index{ipc.c@{ipc.c}!ipc\_drop\_client@{ipc\_drop\_client}}
\index{ipc\_drop\_client@{ipc\_drop\_client}!ipc.c@{ipc.c}}
\doxysubsubsection{\texorpdfstring{ipc\_drop\_client()}{ipc\_drop\_client()}}
{\footnotesize\ttfamily \label{ipc_8c_a2691ad7177c992404f030ec077caf951} 
int ipc\+\_\+drop\+\_\+client (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structIPCClient}{IPCClient}} \texorpdfstring{$\ast$}{*}}]{c}{}\end{DoxyParamCaption})}

Disconnect an IPCClient from the socket and remove the client from the list of known connected clients


\begin{DoxyParams}{Parameters}
{\em c} & Address of IPCClient\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if the client\textquotesingle{}s file descriptor was closed successfully, the result of executing close() on the file descriptor otherwise. 
\end{DoxyReturn}
\Hypertarget{ipc_8c_a4935c3928882f8336e0d13c33c5e923d}\index{ipc.c@{ipc.c}!ipc\_event\_init\_message@{ipc\_event\_init\_message}}
\index{ipc\_event\_init\_message@{ipc\_event\_init\_message}!ipc.c@{ipc.c}}
\doxysubsubsection{\texorpdfstring{ipc\_event\_init\_message()}{ipc\_event\_init\_message()}}
{\footnotesize\ttfamily \label{ipc_8c_a4935c3928882f8336e0d13c33c5e923d} 
static void ipc\+\_\+event\+\_\+init\+\_\+message (\begin{DoxyParamCaption}\item[{yajl\+\_\+gen \texorpdfstring{$\ast$}{*}}]{gen}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

Initialization for generic event message. This is used to allocate the yajl handle, set yajl options, and in the future any other initialization that should occur for event messages. \Hypertarget{ipc_8c_adf8ed4dd3c897d54e359f1b515e11502}\index{ipc.c@{ipc.c}!ipc\_event\_prepare\_send\_message@{ipc\_event\_prepare\_send\_message}}
\index{ipc\_event\_prepare\_send\_message@{ipc\_event\_prepare\_send\_message}!ipc.c@{ipc.c}}
\doxysubsubsection{\texorpdfstring{ipc\_event\_prepare\_send\_message()}{ipc\_event\_prepare\_send\_message()}}
{\footnotesize\ttfamily \label{ipc_8c_adf8ed4dd3c897d54e359f1b515e11502} 
static void ipc\+\_\+event\+\_\+prepare\+\_\+send\+\_\+message (\begin{DoxyParamCaption}\item[{yajl\+\_\+gen}]{gen}{, }\item[{IPCEvent}]{event}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

Prepares buffers of IPC subscribers of specified event using buffer from yajl handle. \Hypertarget{ipc_8c_a59a776fc01c2e23d5d7b9dab10ae9b9c}\index{ipc.c@{ipc.c}!ipc\_event\_stoi@{ipc\_event\_stoi}}
\index{ipc\_event\_stoi@{ipc\_event\_stoi}!ipc.c@{ipc.c}}
\doxysubsubsection{\texorpdfstring{ipc\_event\_stoi()}{ipc\_event\_stoi()}}
{\footnotesize\ttfamily \label{ipc_8c_a59a776fc01c2e23d5d7b9dab10ae9b9c} 
static int ipc\+\_\+event\+\_\+stoi (\begin{DoxyParamCaption}\item[{const char \texorpdfstring{$\ast$}{*}}]{subscription}{, }\item[{IPCEvent \texorpdfstring{$\ast$}{*}}]{event}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

Convert event name to their IPCEvent equivalent enum value

Returns 0 if a valid event name was given Returns -\/1 otherwise \Hypertarget{ipc_8c_aafbc9c45dbce577a3a62275f72d63867}\index{ipc.c@{ipc.c}!ipc\_focused\_state\_change\_event@{ipc\_focused\_state\_change\_event}}
\index{ipc\_focused\_state\_change\_event@{ipc\_focused\_state\_change\_event}!ipc.c@{ipc.c}}
\doxysubsubsection{\texorpdfstring{ipc\_focused\_state\_change\_event()}{ipc\_focused\_state\_change\_event()}}
{\footnotesize\ttfamily \label{ipc_8c_aafbc9c45dbce577a3a62275f72d63867} 
void ipc\+\_\+focused\+\_\+state\+\_\+change\+\_\+event (\begin{DoxyParamCaption}\item[{const int}]{mon\+\_\+num}{, }\item[{const Window}]{client\+\_\+id}{, }\item[{const \mbox{\hyperlink{structClientState}{Client\+State}} \texorpdfstring{$\ast$}{*}}]{old\+\_\+state}{, }\item[{const \mbox{\hyperlink{structClientState}{Client\+State}} \texorpdfstring{$\ast$}{*}}]{new\+\_\+state}{}\end{DoxyParamCaption})}

Send a focused\+\_\+state\+\_\+change\+\_\+event to all subscribers. Should only be called if a selected client has a state change.


\begin{DoxyParams}{Parameters}
{\em mon\+\_\+num} & Index of the client\textquotesingle{}s monitor \\
\hline
{\em client\+\_\+id} & Window XID of client \\
\hline
{\em old\+\_\+state} & Old state of the client \\
\hline
{\em new\+\_\+state} & New state of the client \\
\hline
\end{DoxyParams}
\Hypertarget{ipc_8c_aa641e7730c197a51c3e68fca7cc07ee5}\index{ipc.c@{ipc.c}!ipc\_focused\_title\_change\_event@{ipc\_focused\_title\_change\_event}}
\index{ipc\_focused\_title\_change\_event@{ipc\_focused\_title\_change\_event}!ipc.c@{ipc.c}}
\doxysubsubsection{\texorpdfstring{ipc\_focused\_title\_change\_event()}{ipc\_focused\_title\_change\_event()}}
{\footnotesize\ttfamily \label{ipc_8c_aa641e7730c197a51c3e68fca7cc07ee5} 
void ipc\+\_\+focused\+\_\+title\+\_\+change\+\_\+event (\begin{DoxyParamCaption}\item[{const int}]{mon\+\_\+num}{, }\item[{const Window}]{client\+\_\+id}{, }\item[{const char \texorpdfstring{$\ast$}{*}}]{old\+\_\+name}{, }\item[{const char \texorpdfstring{$\ast$}{*}}]{new\+\_\+name}{}\end{DoxyParamCaption})}

Send a focused\+\_\+title\+\_\+change\+\_\+event to all subscribers. Should only be called if a selected client has a title change.


\begin{DoxyParams}{Parameters}
{\em mon\+\_\+num} & Index of the client\textquotesingle{}s monitor \\
\hline
{\em client\+\_\+id} & Window XID of client \\
\hline
{\em old\+\_\+name} & Old name of the client window \\
\hline
{\em new\+\_\+name} & New name of the client window \\
\hline
\end{DoxyParams}
\Hypertarget{ipc_8c_a8dd4ef35088efa38b07140e9517d7191}\index{ipc.c@{ipc.c}!ipc\_free\_parsed\_command\_members@{ipc\_free\_parsed\_command\_members}}
\index{ipc\_free\_parsed\_command\_members@{ipc\_free\_parsed\_command\_members}!ipc.c@{ipc.c}}
\doxysubsubsection{\texorpdfstring{ipc\_free\_parsed\_command\_members()}{ipc\_free\_parsed\_command\_members()}}
{\footnotesize\ttfamily \label{ipc_8c_a8dd4ef35088efa38b07140e9517d7191} 
static void ipc\+\_\+free\+\_\+parsed\+\_\+command\+\_\+members (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structIPCParsedCommand}{IPCParsed\+Command}} \texorpdfstring{$\ast$}{*}}]{command}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

Free the members of a IPCParsed\+Command struct \Hypertarget{ipc_8c_a3547c5a2191240ab550d351548bf74da}\index{ipc.c@{ipc.c}!ipc\_get\_client@{ipc\_get\_client}}
\index{ipc\_get\_client@{ipc\_get\_client}!ipc.c@{ipc.c}}
\doxysubsubsection{\texorpdfstring{ipc\_get\_client()}{ipc\_get\_client()}}
{\footnotesize\ttfamily \label{ipc_8c_a3547c5a2191240ab550d351548bf74da} 
\mbox{\hyperlink{structIPCClient}{IPCClient}} \texorpdfstring{$\ast$}{*} ipc\+\_\+get\+\_\+client (\begin{DoxyParamCaption}\item[{int}]{fd}{}\end{DoxyParamCaption})}

Get address to IPCClient with specified file descriptor


\begin{DoxyParams}{Parameters}
{\em fd} & File descriptor of IPC Client\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Address to IPCClient with specified file descriptor, -\/1 otherwise 
\end{DoxyReturn}
\Hypertarget{ipc_8c_a240daa63677ae1333ead3c287a086e8a}\index{ipc.c@{ipc.c}!ipc\_get\_dwm\_client@{ipc\_get\_dwm\_client}}
\index{ipc\_get\_dwm\_client@{ipc\_get\_dwm\_client}!ipc.c@{ipc.c}}
\doxysubsubsection{\texorpdfstring{ipc\_get\_dwm\_client()}{ipc\_get\_dwm\_client()}}
{\footnotesize\ttfamily \label{ipc_8c_a240daa63677ae1333ead3c287a086e8a} 
static int ipc\+\_\+get\+\_\+dwm\+\_\+client (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structIPCClient}{IPCClient}} \texorpdfstring{$\ast$}{*}}]{ipc\+\_\+client}{, }\item[{const char \texorpdfstring{$\ast$}{*}}]{msg}{, }\item[{const \mbox{\hyperlink{structMonitor}{Monitor}} \texorpdfstring{$\ast$}{*}}]{mons}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

Called when an IPC\+\_\+\+TYPE\+\_\+\+GET\+\_\+\+DWM\+\_\+\+CLIENT message is received from a client. It prepares a JSON reply with the properties of the client with the specified window XID.

Returns 0 if the message was successfully parsed and if the client with the specified window XID was found Returns -\/1 if the message could not be parsed \Hypertarget{ipc_8c_ab90da44218163c22a2e1bd7fcb11f326}\index{ipc.c@{ipc.c}!ipc\_get\_ipc\_command@{ipc\_get\_ipc\_command}}
\index{ipc\_get\_ipc\_command@{ipc\_get\_ipc\_command}!ipc.c@{ipc.c}}
\doxysubsubsection{\texorpdfstring{ipc\_get\_ipc\_command()}{ipc\_get\_ipc\_command()}}
{\footnotesize\ttfamily \label{ipc_8c_ab90da44218163c22a2e1bd7fcb11f326} 
static int ipc\+\_\+get\+\_\+ipc\+\_\+command (\begin{DoxyParamCaption}\item[{const char \texorpdfstring{$\ast$}{*}}]{name}{, }\item[{\mbox{\hyperlink{structIPCCommand}{IPCCommand}} \texorpdfstring{$\ast$}{*}}]{ipc\+\_\+command}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

Find the IPCCommand with the specified name

Returns 0 if a command with the specified name was found Returns -\/1 if a command with the specified name could not be found \Hypertarget{ipc_8c_a72c4e39d99a68640f80c5a78ab367dca}\index{ipc.c@{ipc.c}!ipc\_get\_layouts@{ipc\_get\_layouts}}
\index{ipc\_get\_layouts@{ipc\_get\_layouts}!ipc.c@{ipc.c}}
\doxysubsubsection{\texorpdfstring{ipc\_get\_layouts()}{ipc\_get\_layouts()}}
{\footnotesize\ttfamily \label{ipc_8c_a72c4e39d99a68640f80c5a78ab367dca} 
static void ipc\+\_\+get\+\_\+layouts (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structIPCClient}{IPCClient}} \texorpdfstring{$\ast$}{*}}]{c}{, }\item[{const \mbox{\hyperlink{structLayout}{Layout}}}]{layouts}{\mbox{[}$\,$\mbox{]}, }\item[{const int}]{layouts\+\_\+len}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

Called when an IPC\+\_\+\+TYPE\+\_\+\+GET\+\_\+\+LAYOUTS message is received from a client. It prepares a reply with a JSON array of available layouts \Hypertarget{ipc_8c_a99392099329bbfd860cbba61d7147963}\index{ipc.c@{ipc.c}!ipc\_get\_monitors@{ipc\_get\_monitors}}
\index{ipc\_get\_monitors@{ipc\_get\_monitors}!ipc.c@{ipc.c}}
\doxysubsubsection{\texorpdfstring{ipc\_get\_monitors()}{ipc\_get\_monitors()}}
{\footnotesize\ttfamily \label{ipc_8c_a99392099329bbfd860cbba61d7147963} 
static void ipc\+\_\+get\+\_\+monitors (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structIPCClient}{IPCClient}} \texorpdfstring{$\ast$}{*}}]{c}{, }\item[{\mbox{\hyperlink{structMonitor}{Monitor}} \texorpdfstring{$\ast$}{*}}]{mons}{, }\item[{\mbox{\hyperlink{structMonitor}{Monitor}} \texorpdfstring{$\ast$}{*}}]{selmon}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

Called when an IPC\+\_\+\+TYPE\+\_\+\+GET\+\_\+\+MONITORS message is received from a client. It prepares a reply with the properties of all of the monitors in JSON. \Hypertarget{ipc_8c_aaf6a34c4926a5daeb5e86a3810df1927}\index{ipc.c@{ipc.c}!ipc\_get\_sock\_fd@{ipc\_get\_sock\_fd}}
\index{ipc\_get\_sock\_fd@{ipc\_get\_sock\_fd}!ipc.c@{ipc.c}}
\doxysubsubsection{\texorpdfstring{ipc\_get\_sock\_fd()}{ipc\_get\_sock\_fd()}}
{\footnotesize\ttfamily \label{ipc_8c_aaf6a34c4926a5daeb5e86a3810df1927} 
int ipc\+\_\+get\+\_\+sock\+\_\+fd (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})}

Get the file descriptor of the IPC socket

\begin{DoxyReturn}{Returns}
int File descriptor of IPC socket, -\/1 if socket not created. 
\end{DoxyReturn}
\Hypertarget{ipc_8c_a14c26dbee01f2d8994aac3e546174787}\index{ipc.c@{ipc.c}!ipc\_get\_tags@{ipc\_get\_tags}}
\index{ipc\_get\_tags@{ipc\_get\_tags}!ipc.c@{ipc.c}}
\doxysubsubsection{\texorpdfstring{ipc\_get\_tags()}{ipc\_get\_tags()}}
{\footnotesize\ttfamily \label{ipc_8c_a14c26dbee01f2d8994aac3e546174787} 
static void ipc\+\_\+get\+\_\+tags (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structIPCClient}{IPCClient}} \texorpdfstring{$\ast$}{*}}]{c}{, }\item[{const char \texorpdfstring{$\ast$}{*}}]{tags}{\mbox{[}$\,$\mbox{]}, }\item[{const int}]{tags\+\_\+len}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

Called when an IPC\+\_\+\+TYPE\+\_\+\+GET\+\_\+\+TAGS message is received from a client. It prepares a reply with info about all the tags in JSON. \Hypertarget{ipc_8c_ac2e89d3423dd343b78dd422ec54e6dce}\index{ipc.c@{ipc.c}!ipc\_handle\_client\_epoll\_event@{ipc\_handle\_client\_epoll\_event}}
\index{ipc\_handle\_client\_epoll\_event@{ipc\_handle\_client\_epoll\_event}!ipc.c@{ipc.c}}
\doxysubsubsection{\texorpdfstring{ipc\_handle\_client\_epoll\_event()}{ipc\_handle\_client\_epoll\_event()}}
{\footnotesize\ttfamily \label{ipc_8c_ac2e89d3423dd343b78dd422ec54e6dce} 
int ipc\+\_\+handle\+\_\+client\+\_\+epoll\+\_\+event (\begin{DoxyParamCaption}\item[{struct epoll\+\_\+event \texorpdfstring{$\ast$}{*}}]{ev}{, }\item[{\mbox{\hyperlink{structMonitor}{Monitor}} \texorpdfstring{$\ast$}{*}}]{mons}{, }\item[{\mbox{\hyperlink{structMonitor}{Monitor}} \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}}]{lastselmon}{, }\item[{\mbox{\hyperlink{structMonitor}{Monitor}} \texorpdfstring{$\ast$}{*}}]{selmon}{, }\item[{const char \texorpdfstring{$\ast$}{*}}]{tags}{\mbox{[}$\,$\mbox{]}, }\item[{const int}]{tags\+\_\+len}{, }\item[{const \mbox{\hyperlink{structLayout}{Layout}} \texorpdfstring{$\ast$}{*}}]{layouts}{, }\item[{const int}]{layouts\+\_\+len}{}\end{DoxyParamCaption})}

Handle an epoll event caused by a registered IPC client. Read, process, and handle any received messages from clients. Write pending buffer to client if the client is ready to receive messages. Drop clients that have sent an EPOLLHUP.


\begin{DoxyParams}{Parameters}
{\em ev} & Associated epoll event returned by epoll\+\_\+wait \\
\hline
{\em mons} & Address of Monitor pointing to start of linked list \\
\hline
{\em selmon} & Address of selected Monitor \\
\hline
{\em lastselmon} & Address of pointer to previously selected monitor \\
\hline
{\em tags} & Array of tag names \\
\hline
{\em tags\+\_\+len} & Length of tags array \\
\hline
{\em layouts} & Array of available layouts \\
\hline
{\em layouts\+\_\+len} & Length of layouts array\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if event was successfully handled, -\/1 on any error receiving or handling incoming messages or unhandled epoll event. 
\end{DoxyReturn}
\Hypertarget{ipc_8c_a90ff3f5975686c3cefb6da204077fc9d}\index{ipc.c@{ipc.c}!ipc\_handle\_socket\_epoll\_event@{ipc\_handle\_socket\_epoll\_event}}
\index{ipc\_handle\_socket\_epoll\_event@{ipc\_handle\_socket\_epoll\_event}!ipc.c@{ipc.c}}
\doxysubsubsection{\texorpdfstring{ipc\_handle\_socket\_epoll\_event()}{ipc\_handle\_socket\_epoll\_event()}}
{\footnotesize\ttfamily \label{ipc_8c_a90ff3f5975686c3cefb6da204077fc9d} 
int ipc\+\_\+handle\+\_\+socket\+\_\+epoll\+\_\+event (\begin{DoxyParamCaption}\item[{struct epoll\+\_\+event \texorpdfstring{$\ast$}{*}}]{ev}{}\end{DoxyParamCaption})}

Handle an epoll event caused by the IPC socket. This function only handles an EPOLLIN event indicating a new client requesting to connect to the socket.


\begin{DoxyParams}{Parameters}
{\em ev} & Associated epoll event returned by epoll\+\_\+wait\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0, if the event was successfully handled, -\/1 if not an EPOLLIN event or if a new IPC client connection request could not be accepted. 
\end{DoxyReturn}
\Hypertarget{ipc_8c_a0075a47c0fd4b8176a483263b656aa55}\index{ipc.c@{ipc.c}!ipc\_init@{ipc\_init}}
\index{ipc\_init@{ipc\_init}!ipc.c@{ipc.c}}
\doxysubsubsection{\texorpdfstring{ipc\_init()}{ipc\_init()}}
{\footnotesize\ttfamily \label{ipc_8c_a0075a47c0fd4b8176a483263b656aa55} 
int ipc\+\_\+init (\begin{DoxyParamCaption}\item[{const char \texorpdfstring{$\ast$}{*}}]{socket\+\_\+path}{, }\item[{const int}]{p\+\_\+epoll\+\_\+fd}{, }\item[{\mbox{\hyperlink{structIPCCommand}{IPCCommand}}}]{commands}{\mbox{[}$\,$\mbox{]}, }\item[{const int}]{commands\+\_\+len}{}\end{DoxyParamCaption})}

Initialize the IPC socket and the IPC module


\begin{DoxyParams}{Parameters}
{\em socket\+\_\+path} & Path to create the socket at \\
\hline
{\em epoll\+\_\+fd} & File descriptor for epoll \\
\hline
{\em commands} & Address of IPCCommands array defined in config.\+h \\
\hline
{\em commands\+\_\+len} & Length of commands\mbox{[}\mbox{]} array\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
int The file descriptor of the socket if it was successfully created, -\/1 otherwise 
\end{DoxyReturn}
\Hypertarget{ipc_8c_a7b06b9405d28f83b70abef476c96586b}\index{ipc.c@{ipc.c}!ipc\_is\_client\_registered@{ipc\_is\_client\_registered}}
\index{ipc\_is\_client\_registered@{ipc\_is\_client\_registered}!ipc.c@{ipc.c}}
\doxysubsubsection{\texorpdfstring{ipc\_is\_client\_registered()}{ipc\_is\_client\_registered()}}
{\footnotesize\ttfamily \label{ipc_8c_a7b06b9405d28f83b70abef476c96586b} 
int ipc\+\_\+is\+\_\+client\+\_\+registered (\begin{DoxyParamCaption}\item[{int}]{fd}{}\end{DoxyParamCaption})}

Check if an IPC client exists with the specified file descriptor


\begin{DoxyParams}{Parameters}
{\em fd} & File descriptor\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
int 1 if client exists, 0 otherwise 
\end{DoxyReturn}
\Hypertarget{ipc_8c_ac93313ec475fade29aa3f6182624da88}\index{ipc.c@{ipc.c}!ipc\_layout\_change\_event@{ipc\_layout\_change\_event}}
\index{ipc\_layout\_change\_event@{ipc\_layout\_change\_event}!ipc.c@{ipc.c}}
\doxysubsubsection{\texorpdfstring{ipc\_layout\_change\_event()}{ipc\_layout\_change\_event()}}
{\footnotesize\ttfamily \label{ipc_8c_ac93313ec475fade29aa3f6182624da88} 
void ipc\+\_\+layout\+\_\+change\+\_\+event (\begin{DoxyParamCaption}\item[{const int}]{mon\+\_\+num}{, }\item[{const char \texorpdfstring{$\ast$}{*}}]{old\+\_\+symbol}{, }\item[{const \mbox{\hyperlink{structLayout}{Layout}} \texorpdfstring{$\ast$}{*}}]{old\+\_\+layout}{, }\item[{const char \texorpdfstring{$\ast$}{*}}]{new\+\_\+symbol}{, }\item[{const \mbox{\hyperlink{structLayout}{Layout}} \texorpdfstring{$\ast$}{*}}]{new\+\_\+layout}{}\end{DoxyParamCaption})}

Send a layout\+\_\+change\+\_\+event to all subscribers. Should be called only when there has been a layout change.


\begin{DoxyParams}{Parameters}
{\em mon\+\_\+num} & The index of the monitor (Monitor.\+num property) \\
\hline
{\em old\+\_\+symbol} & The old layout symbol \\
\hline
{\em old\+\_\+layout} & Address to the old Layout \\
\hline
{\em new\+\_\+symbol} & The new (now current) layout symbol \\
\hline
{\em new\+\_\+layout} & Address to the new Layout \\
\hline
\end{DoxyParams}
\Hypertarget{ipc_8c_a30f10dd1fb42c40505a0bb0e554e1f1a}\index{ipc.c@{ipc.c}!ipc\_monitor\_focus\_change\_event@{ipc\_monitor\_focus\_change\_event}}
\index{ipc\_monitor\_focus\_change\_event@{ipc\_monitor\_focus\_change\_event}!ipc.c@{ipc.c}}
\doxysubsubsection{\texorpdfstring{ipc\_monitor\_focus\_change\_event()}{ipc\_monitor\_focus\_change\_event()}}
{\footnotesize\ttfamily \label{ipc_8c_a30f10dd1fb42c40505a0bb0e554e1f1a} 
void ipc\+\_\+monitor\+\_\+focus\+\_\+change\+\_\+event (\begin{DoxyParamCaption}\item[{const int}]{last\+\_\+mon\+\_\+num}{, }\item[{const int}]{new\+\_\+mon\+\_\+num}{}\end{DoxyParamCaption})}

Send a monitor\+\_\+focus\+\_\+change\+\_\+event to all subscribers. Should be called only when the monitor focus changes.


\begin{DoxyParams}{Parameters}
{\em last\+\_\+mon\+\_\+num} & The index of the previously selected monitor \\
\hline
{\em new\+\_\+mon\+\_\+num} & The index of the newly selected monitor \\
\hline
\end{DoxyParams}
\Hypertarget{ipc_8c_aa78fb2d629fe72e8494b88cb39b500e1}\index{ipc.c@{ipc.c}!ipc\_parse\_get\_dwm\_client@{ipc\_parse\_get\_dwm\_client}}
\index{ipc\_parse\_get\_dwm\_client@{ipc\_parse\_get\_dwm\_client}!ipc.c@{ipc.c}}
\doxysubsubsection{\texorpdfstring{ipc\_parse\_get\_dwm\_client()}{ipc\_parse\_get\_dwm\_client()}}
{\footnotesize\ttfamily \label{ipc_8c_aa78fb2d629fe72e8494b88cb39b500e1} 
static int ipc\+\_\+parse\+\_\+get\+\_\+dwm\+\_\+client (\begin{DoxyParamCaption}\item[{const char \texorpdfstring{$\ast$}{*}}]{msg}{, }\item[{Window \texorpdfstring{$\ast$}{*}}]{win}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

Parse an IPC\+\_\+\+TYPE\+\_\+\+GET\+\_\+\+DWM\+\_\+\+CLIENT message from a client. This function extracts the window id from the message.

Returns 0 if message was successfully parsed Returns -\/1 otherwise \Hypertarget{ipc_8c_a2bbc25ad0d14a7a741b613c2ef9ba951}\index{ipc.c@{ipc.c}!ipc\_parse\_run\_command@{ipc\_parse\_run\_command}}
\index{ipc\_parse\_run\_command@{ipc\_parse\_run\_command}!ipc.c@{ipc.c}}
\doxysubsubsection{\texorpdfstring{ipc\_parse\_run\_command()}{ipc\_parse\_run\_command()}}
{\footnotesize\ttfamily \label{ipc_8c_a2bbc25ad0d14a7a741b613c2ef9ba951} 
static int ipc\+\_\+parse\+\_\+run\+\_\+command (\begin{DoxyParamCaption}\item[{char \texorpdfstring{$\ast$}{*}}]{msg}{, }\item[{\mbox{\hyperlink{structIPCParsedCommand}{IPCParsed\+Command}} \texorpdfstring{$\ast$}{*}}]{parsed\+\_\+command}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

Parse a IPC\+\_\+\+TYPE\+\_\+\+RUN\+\_\+\+COMMAND message from a client. This function extracts the arguments, argument count, argument types, and command name and returns the parsed information as an IPCParsed\+Command. If this function returns successfully, the parsed\+\_\+command must be freed using ipc\+\_\+free\+\_\+parsed\+\_\+command\+\_\+members.

Returns 0 if the message was successfully parsed Returns -\/1 otherwise \Hypertarget{ipc_8c_af2c9b7fcd327dfb3bef6bce5d6c8b88a}\index{ipc.c@{ipc.c}!ipc\_parse\_subscribe@{ipc\_parse\_subscribe}}
\index{ipc\_parse\_subscribe@{ipc\_parse\_subscribe}!ipc.c@{ipc.c}}
\doxysubsubsection{\texorpdfstring{ipc\_parse\_subscribe()}{ipc\_parse\_subscribe()}}
{\footnotesize\ttfamily \label{ipc_8c_af2c9b7fcd327dfb3bef6bce5d6c8b88a} 
static int ipc\+\_\+parse\+\_\+subscribe (\begin{DoxyParamCaption}\item[{const char \texorpdfstring{$\ast$}{*}}]{msg}{, }\item[{IPCSubscription\+Action \texorpdfstring{$\ast$}{*}}]{subscribe}{, }\item[{IPCEvent \texorpdfstring{$\ast$}{*}}]{event}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

Parse a IPC\+\_\+\+TYPE\+\_\+\+SUBSCRIBE message from a client. This function extracts the event name and the subscription action from the message.

Returns 0 if message was successfully parsed Returns -\/1 otherwise \Hypertarget{ipc_8c_a6efdf4e155c8f0affd6a54036b4583ba}\index{ipc.c@{ipc.c}!ipc\_prepare\_reply\_failure@{ipc\_prepare\_reply\_failure}}
\index{ipc\_prepare\_reply\_failure@{ipc\_prepare\_reply\_failure}!ipc.c@{ipc.c}}
\doxysubsubsection{\texorpdfstring{ipc\_prepare\_reply\_failure()}{ipc\_prepare\_reply\_failure()}}
{\footnotesize\ttfamily \label{ipc_8c_a6efdf4e155c8f0affd6a54036b4583ba} 
void ipc\+\_\+prepare\+\_\+reply\+\_\+failure (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structIPCClient}{IPCClient}} \texorpdfstring{$\ast$}{*}}]{c}{, }\item[{IPCMessage\+Type}]{msg\+\_\+type}{, }\item[{const char \texorpdfstring{$\ast$}{*}}]{format}{, }\item[{}]{...}{}\end{DoxyParamCaption})}

Prepare an error message in the specified client\textquotesingle{}s buffer


\begin{DoxyParams}{Parameters}
{\em c} & Client to prepare message for \\
\hline
{\em msg\+\_\+type} & Type of message \\
\hline
{\em format} & Format string following vsprintf \\
\hline
{\em ...} & Arguments for format string \\
\hline
\end{DoxyParams}
\Hypertarget{ipc_8c_a4de330d510471cdc8ab4e81ce6b454ec}\index{ipc.c@{ipc.c}!ipc\_prepare\_reply\_success@{ipc\_prepare\_reply\_success}}
\index{ipc\_prepare\_reply\_success@{ipc\_prepare\_reply\_success}!ipc.c@{ipc.c}}
\doxysubsubsection{\texorpdfstring{ipc\_prepare\_reply\_success()}{ipc\_prepare\_reply\_success()}}
{\footnotesize\ttfamily \label{ipc_8c_a4de330d510471cdc8ab4e81ce6b454ec} 
void ipc\+\_\+prepare\+\_\+reply\+\_\+success (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structIPCClient}{IPCClient}} \texorpdfstring{$\ast$}{*}}]{c}{, }\item[{IPCMessage\+Type}]{msg\+\_\+type}{}\end{DoxyParamCaption})}

Prepare a success message in the specified client\textquotesingle{}s buffer


\begin{DoxyParams}{Parameters}
{\em c} & Client to prepare message for \\
\hline
{\em msg\+\_\+type} & Type of message \\
\hline
\end{DoxyParams}
\Hypertarget{ipc_8c_a3f8724e9a4d13f3f740424b4bd2cd320}\index{ipc.c@{ipc.c}!ipc\_prepare\_send\_message@{ipc\_prepare\_send\_message}}
\index{ipc\_prepare\_send\_message@{ipc\_prepare\_send\_message}!ipc.c@{ipc.c}}
\doxysubsubsection{\texorpdfstring{ipc\_prepare\_send\_message()}{ipc\_prepare\_send\_message()}}
{\footnotesize\ttfamily \label{ipc_8c_a3f8724e9a4d13f3f740424b4bd2cd320} 
void ipc\+\_\+prepare\+\_\+send\+\_\+message (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structIPCClient}{IPCClient}} \texorpdfstring{$\ast$}{*}}]{c}{, }\item[{const IPCMessage\+Type}]{msg\+\_\+type}{, }\item[{const uint32\+\_\+t}]{msg\+\_\+size}{, }\item[{const char \texorpdfstring{$\ast$}{*}}]{msg}{}\end{DoxyParamCaption})}

Prepare a message in the specified client\textquotesingle{}s buffer.


\begin{DoxyParams}{Parameters}
{\em c} & Client to prepare message for \\
\hline
{\em msg\+\_\+type} & Type of message to prepare \\
\hline
{\em msg\+\_\+size} & Size of the message in bytes. Should not exceed MAX\+\_\+\+MESSAGE\+\_\+\+SIZE \\
\hline
{\em msg} & Message to prepare (not including header). This pointer can be freed after the function invocation. \\
\hline
\end{DoxyParams}
\Hypertarget{ipc_8c_a7fc2b53d563fbe5b5cd2d18ed896515a}\index{ipc.c@{ipc.c}!ipc\_read\_client@{ipc\_read\_client}}
\index{ipc\_read\_client@{ipc\_read\_client}!ipc.c@{ipc.c}}
\doxysubsubsection{\texorpdfstring{ipc\_read\_client()}{ipc\_read\_client()}}
{\footnotesize\ttfamily \label{ipc_8c_a7fc2b53d563fbe5b5cd2d18ed896515a} 
int ipc\+\_\+read\+\_\+client (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structIPCClient}{IPCClient}} \texorpdfstring{$\ast$}{*}}]{c}{, }\item[{IPCMessage\+Type \texorpdfstring{$\ast$}{*}}]{msg\+\_\+type}{, }\item[{uint32\+\_\+t \texorpdfstring{$\ast$}{*}}]{msg\+\_\+size}{, }\item[{char \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}}]{msg}{}\end{DoxyParamCaption})}

Read an incoming message from an accepted IPC client


\begin{DoxyParams}{Parameters}
{\em c} & Address of IPCClient \\
\hline
{\em msg\+\_\+type} & Address to IPCMessage\+Type variable which will be assigned the message type of the received message \\
\hline
{\em msg\+\_\+size} & Address to uint32\+\_\+t variable which will be assigned the size of the received message \\
\hline
{\em msg} & Address to char\texorpdfstring{$\ast$}{*} variable which will be assigned the address of the received message. This must be freed using free().\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success, -\/1 on error reading message, -\/2 if reading the message resulted in EAGAIN, EINTR, or EWOULDBLOCK. 
\end{DoxyReturn}
\Hypertarget{ipc_8c_a7fd2c1a0cc44fbe09d6f988ca7c99a88}\index{ipc.c@{ipc.c}!ipc\_recv\_message@{ipc\_recv\_message}}
\index{ipc\_recv\_message@{ipc\_recv\_message}!ipc.c@{ipc.c}}
\doxysubsubsection{\texorpdfstring{ipc\_recv\_message()}{ipc\_recv\_message()}}
{\footnotesize\ttfamily \label{ipc_8c_a7fd2c1a0cc44fbe09d6f988ca7c99a88} 
static int ipc\+\_\+recv\+\_\+message (\begin{DoxyParamCaption}\item[{int}]{fd}{, }\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{msg\+\_\+type}{, }\item[{uint32\+\_\+t \texorpdfstring{$\ast$}{*}}]{reply\+\_\+size}{, }\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}}]{reply}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

Internal function used to receive IPC messages from a given file descriptor.

Returns -\/1 on error reading (could be EAGAIN or EINTR) Returns -\/2 if EOF before header could be read Returns -\/3 if invalid IPC header Returns -\/4 if message length exceeds MAX\+\_\+\+MESSAGE\+\_\+\+SIZE \Hypertarget{ipc_8c_a8e0ae039e25afaec7105ef098ed57210}\index{ipc.c@{ipc.c}!ipc\_reply\_init\_message@{ipc\_reply\_init\_message}}
\index{ipc\_reply\_init\_message@{ipc\_reply\_init\_message}!ipc.c@{ipc.c}}
\doxysubsubsection{\texorpdfstring{ipc\_reply\_init\_message()}{ipc\_reply\_init\_message()}}
{\footnotesize\ttfamily \label{ipc_8c_a8e0ae039e25afaec7105ef098ed57210} 
static void ipc\+\_\+reply\+\_\+init\+\_\+message (\begin{DoxyParamCaption}\item[{yajl\+\_\+gen \texorpdfstring{$\ast$}{*}}]{gen}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

Initialization for generic reply message. This is used to allocate the yajl handle, set yajl options, and in the future any other initialization that should occur for reply messages. \Hypertarget{ipc_8c_aa5ea924e4684f691acf4bcb261e0fd0c}\index{ipc.c@{ipc.c}!ipc\_reply\_prepare\_send\_message@{ipc\_reply\_prepare\_send\_message}}
\index{ipc\_reply\_prepare\_send\_message@{ipc\_reply\_prepare\_send\_message}!ipc.c@{ipc.c}}
\doxysubsubsection{\texorpdfstring{ipc\_reply\_prepare\_send\_message()}{ipc\_reply\_prepare\_send\_message()}}
{\footnotesize\ttfamily \label{ipc_8c_aa5ea924e4684f691acf4bcb261e0fd0c} 
static void ipc\+\_\+reply\+\_\+prepare\+\_\+send\+\_\+message (\begin{DoxyParamCaption}\item[{yajl\+\_\+gen}]{gen}{, }\item[{\mbox{\hyperlink{structIPCClient}{IPCClient}} \texorpdfstring{$\ast$}{*}}]{c}{, }\item[{IPCMessage\+Type}]{msg\+\_\+type}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

Prepares the IPC client\textquotesingle{}s buffer with a message using the buffer of the yajl handle. \Hypertarget{ipc_8c_a66568f558397fd5df9c108d69c7c8102}\index{ipc.c@{ipc.c}!ipc\_run\_command@{ipc\_run\_command}}
\index{ipc\_run\_command@{ipc\_run\_command}!ipc.c@{ipc.c}}
\doxysubsubsection{\texorpdfstring{ipc\_run\_command()}{ipc\_run\_command()}}
{\footnotesize\ttfamily \label{ipc_8c_a66568f558397fd5df9c108d69c7c8102} 
static int ipc\+\_\+run\+\_\+command (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structIPCClient}{IPCClient}} \texorpdfstring{$\ast$}{*}}]{ipc\+\_\+client}{, }\item[{char \texorpdfstring{$\ast$}{*}}]{msg}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

Called when an IPC\+\_\+\+TYPE\+\_\+\+RUN\+\_\+\+COMMAND message is received from a client. This function parses, executes the given command, and prepares a reply message to the client indicating success/failure.

NOTE\+: There is currently no check for argument validity beyond the number of arguments given and types of arguments. There is also no way to check if the function succeeded based on dwm\textquotesingle{}s void(const Arg\texorpdfstring{$\ast$}{*}) function types. Pointer arguments can cause crashes if they are not validated in the function itself.

Returns 0 if message was successfully parsed Returns -\/1 on failure parsing message \Hypertarget{ipc_8c_a501706e7a2244abe719cefa19a6cfb04}\index{ipc.c@{ipc.c}!ipc\_send\_events@{ipc\_send\_events}}
\index{ipc\_send\_events@{ipc\_send\_events}!ipc.c@{ipc.c}}
\doxysubsubsection{\texorpdfstring{ipc\_send\_events()}{ipc\_send\_events()}}
{\footnotesize\ttfamily \label{ipc_8c_a501706e7a2244abe719cefa19a6cfb04} 
void ipc\+\_\+send\+\_\+events (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structMonitor}{Monitor}} \texorpdfstring{$\ast$}{*}}]{mons}{, }\item[{\mbox{\hyperlink{structMonitor}{Monitor}} \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}}]{lastselmon}{, }\item[{\mbox{\hyperlink{structMonitor}{Monitor}} \texorpdfstring{$\ast$}{*}}]{selmon}{}\end{DoxyParamCaption})}

Check to see if an event has occured and call the \texorpdfstring{$\ast$}{*}\+\_\+change\+\_\+event functions accordingly


\begin{DoxyParams}{Parameters}
{\em mons} & Address of Monitor pointing to start of linked list \\
\hline
{\em lastselmon} & Address of pointer to previously selected monitor \\
\hline
{\em selmon} & Address of selected Monitor \\
\hline
\end{DoxyParams}
\Hypertarget{ipc_8c_ae95a061a3193d0f615183dc704c62717}\index{ipc.c@{ipc.c}!ipc\_subscribe@{ipc\_subscribe}}
\index{ipc\_subscribe@{ipc\_subscribe}!ipc.c@{ipc.c}}
\doxysubsubsection{\texorpdfstring{ipc\_subscribe()}{ipc\_subscribe()}}
{\footnotesize\ttfamily \label{ipc_8c_ae95a061a3193d0f615183dc704c62717} 
static int ipc\+\_\+subscribe (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structIPCClient}{IPCClient}} \texorpdfstring{$\ast$}{*}}]{c}{, }\item[{const char \texorpdfstring{$\ast$}{*}}]{msg}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

Called when an IPC\+\_\+\+TYPE\+\_\+\+SUBSCRIBE message is received from a client. It subscribes/unsubscribes the client from the specified event and replies with the result.

Returns 0 if the message was successfully parsed. Returns -\/1 if the message could not be parsed \Hypertarget{ipc_8c_a2ff1e8a64c64d31fa5f73ea96b53d04f}\index{ipc.c@{ipc.c}!ipc\_tag\_change\_event@{ipc\_tag\_change\_event}}
\index{ipc\_tag\_change\_event@{ipc\_tag\_change\_event}!ipc.c@{ipc.c}}
\doxysubsubsection{\texorpdfstring{ipc\_tag\_change\_event()}{ipc\_tag\_change\_event()}}
{\footnotesize\ttfamily \label{ipc_8c_a2ff1e8a64c64d31fa5f73ea96b53d04f} 
void ipc\+\_\+tag\+\_\+change\+\_\+event (\begin{DoxyParamCaption}\item[{const int}]{mon\+\_\+num}{, }\item[{\mbox{\hyperlink{structTagState}{Tag\+State}}}]{old\+\_\+state}{, }\item[{\mbox{\hyperlink{structTagState}{Tag\+State}}}]{new\+\_\+state}{}\end{DoxyParamCaption})}

Send a tag\+\_\+change\+\_\+event to all subscribers. Should be called only when there has been a tag state change.


\begin{DoxyParams}{Parameters}
{\em mon\+\_\+num} & The index of the monitor (Monitor.\+num property) \\
\hline
{\em old\+\_\+state} & The old tag state \\
\hline
{\em new\+\_\+state} & The new (now current) tag state \\
\hline
\end{DoxyParams}
\Hypertarget{ipc_8c_a7f64a35eddb67c378b079f8f7373fc66}\index{ipc.c@{ipc.c}!ipc\_validate\_run\_command@{ipc\_validate\_run\_command}}
\index{ipc\_validate\_run\_command@{ipc\_validate\_run\_command}!ipc.c@{ipc.c}}
\doxysubsubsection{\texorpdfstring{ipc\_validate\_run\_command()}{ipc\_validate\_run\_command()}}
{\footnotesize\ttfamily \label{ipc_8c_a7f64a35eddb67c378b079f8f7373fc66} 
static int ipc\+\_\+validate\+\_\+run\+\_\+command (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structIPCParsedCommand}{IPCParsed\+Command}} \texorpdfstring{$\ast$}{*}}]{parsed}{, }\item[{const \mbox{\hyperlink{structIPCCommand}{IPCCommand}}}]{actual}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

Check if the given arguments are the correct length and type. Also do any casting to correct the types.

Returns 0 if the arguments were the correct length and types Returns -\/1 if the argument count doesn\textquotesingle{}t match Returns -\/2 if the argument types don\textquotesingle{}t match \Hypertarget{ipc_8c_a17a7e48abf6934919ddfa34a6b59190b}\index{ipc.c@{ipc.c}!ipc\_write\_client@{ipc\_write\_client}}
\index{ipc\_write\_client@{ipc\_write\_client}!ipc.c@{ipc.c}}
\doxysubsubsection{\texorpdfstring{ipc\_write\_client()}{ipc\_write\_client()}}
{\footnotesize\ttfamily \label{ipc_8c_a17a7e48abf6934919ddfa34a6b59190b} 
ssize\+\_\+t ipc\+\_\+write\+\_\+client (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structIPCClient}{IPCClient}} \texorpdfstring{$\ast$}{*}}]{c}{}\end{DoxyParamCaption})}

Write any pending buffer of the client to the client\textquotesingle{}s socket


\begin{DoxyParams}{Parameters}
{\em c} & Client whose buffer to write\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Number of bytes written \texorpdfstring{$>$}{>}= 0, -\/1 otherwise. errno will still be set from the write operation. 
\end{DoxyReturn}
\Hypertarget{ipc_8c_a86729db12b9db3d911dc592ecc2930f8}\index{ipc.c@{ipc.c}!ipc\_write\_message@{ipc\_write\_message}}
\index{ipc\_write\_message@{ipc\_write\_message}!ipc.c@{ipc.c}}
\doxysubsubsection{\texorpdfstring{ipc\_write\_message()}{ipc\_write\_message()}}
{\footnotesize\ttfamily \label{ipc_8c_a86729db12b9db3d911dc592ecc2930f8} 
static ssize\+\_\+t ipc\+\_\+write\+\_\+message (\begin{DoxyParamCaption}\item[{int}]{fd}{, }\item[{const void \texorpdfstring{$\ast$}{*}}]{buf}{, }\item[{size\+\_\+t}]{count}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

Internal function used to write a buffer to a file descriptor

Returns number of bytes written if successful write Returns 0 if no bytes were written due to EAGAIN or EWOULDBLOCK Returns -\/1 on unknown error trying to write, errno will carry over from write() call 